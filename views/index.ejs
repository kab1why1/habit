<% const habits = (locals && locals.habits) ? locals.habits : []; %>

<main>
  <section class="stats-grid">
    <div class="card">
      <h3>Total Habits</h3>
      <p class="value"><%= habits.length %></p>
    </div>
    <div class="card">
      <h3>Today's Progress</h3>
      <p class="value">0/0</p>
    </div>
    <div class="card">
      <h3>Best Streak</h3>
      <p class="value">0 days</p>
    </div>
    <div class="card">
      <h3>Total Completions</h3>
      <p class="value">1</p>
    </div>
  </section>

  <section class="week">
    <h2>This Week</h2>
    <div class="week-days">
      <!-- your week markup -->
    </div>
  </section>

  <section class="today-habits">
    <% if (habits.length === 0) { %>
      <div class="empty-icon">ðŸŽ¯</div>
      <h3>No habits yet</h3>
      <p>Create your first habit to start your journey</p>
      <% if (user) { %>
        <a href="/habits/new" class="create-btn">+ Create Your First Habit</a>
      <% } else { %>
        <a href="/login" class="create-btn">Login to create a habit</a>
      <% } %>
    <% } else { %>
      <% habits.forEach(h => { %>
        <div class="card habit-list-item">
          <h4><a href="/habits/<%= h.id %>"><%= h.title %></a></h4>
          <p><%= h.description ? h.description.slice(0, 150) : '' %></p>
          <div class="habit-controls">
            <a href="/habits/<%= h.id %>/edit" class="btn btn-small">Edit</a>
            <form action="/habits/<%= h.id %>/delete" method="POST" style="display:inline;">
              <button type="submit" class="btn btn-danger btn-small" onclick="return confirm('Delete this habit?')">Delete</button>
            </form>
          </div>
        </div>
      <% }) %>
    <% } %>
  </section>
</main>
